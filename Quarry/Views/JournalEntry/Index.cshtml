@model IEnumerable<QuarryManagementSystem.Models.Domain.JournalEntry>

@{
    ViewData["Title"] = "Journal Entries";
}

@section Breadcrumb {
    <ol class="breadcrumb float-sm-right">
        <li class="breadcrumb-item"><a href="@Url.Action("Index", "Dashboard")">Dashboard</a></li>
        <li class="breadcrumb-item active">Journal Entries</li>
    </ol>
}

<div class="card">
    <div class="card-header">
        <h3 class="card-title">Journal Entries</h3>
        <div class="card-tools">
            <form method="get" class="form-inline">
                <div class="form-group mr-2">
                    <label for="fromDate" class="mr-1 mb-0">From</label>
                    <input type="date" id="fromDate" name="fromDate" value="@ViewBag.FromDate" class="form-control form-control-sm" />
                </div>
                <div class="form-group mr-2">
                    <label for="toDate" class="mr-1 mb-0">To</label>
                    <input type="date" id="toDate" name="toDate" value="@ViewBag.ToDate" class="form-control form-control-sm" />
                </div>
                <button type="submit" class="btn btn-sm btn-primary">
                    <i class="fas fa-search"></i> Filter
                </button>
            </form>
        </div>
    </div>
    <div class="card-body table-responsive p-0">
        <table class="table table-hover table-striped table-sm">
            <thead>
                <tr>
                    <th>Entry No.</th>
                    <th>Date</th>
                    <th>Reference</th>
                    <th>Description</th>
                    <th class="text-right">Total Debit (₦)</th>
                    <th class="text-right">Total Credit (₦)</th>
                    <th>Status</th>
                    <th style="width: 80px;"></th>
                </tr>
            </thead>
            <tbody>
@if (Model != null && Model.Any())
{
    foreach (var item in Model)
    {
        var balanced = item.TotalDebit == item.TotalCredit;
        <tr class="@(balanced ? string.Empty : "table-danger")">
            <td>@item.EntryNumber</td>
            <td>@item.EntryDate.ToString("yyyy-MM-dd")</td>
            <td>@item.Reference</td>
            <td>@item.Description</td>
            <td class="text-right">@item.TotalDebit.ToString("N2")</td>
            <td class="text-right">@item.TotalCredit.ToString("N2")</td>
            <td>
                @if (balanced)
                {
                    <span class="badge badge-success">@item.GetStatus()</span>
                }
                else
                {
                    <span class="badge badge-danger">Unbalanced</span>
                }

                @if (item.IsAutoGenerated)
                {
                    <span class="badge badge-info ml-1">Auto</span>
                }
            </td>
            <td class="text-right">
                <a asp-action="Details" asp-route-id="@item.Id" class="btn btn-xs btn-outline-primary">Details</a>
            </td>
        </tr>
    }
}
else
{
    <tr>
        <td colspan="8" class="text-center text-muted">No journal entries found for the selected period.</td>
    </tr>
}
            </tbody>
        </table>
    </div>
</div>